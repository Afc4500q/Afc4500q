<body>
  <h1>رسائل العملاء</h1>
  <div id="messages"></div>
  
  <script>
    const botToken = '7571233461:AAH8lJsUeuKV_L57A42C6pE5i7FFi1_LIak'; // استبدل بتوكن البوت

    // استدعاء الرسائل الجديدة
    async function getUpdates(offset) {
      try {
        const response = await fetch(
          `https://api.telegram.org/bot${botToken}/getUpdates?offset=${offset}`
        );
        const data = await response.json();

        if (data.ok) {
          for (const update of data.result) {
            const chatId = update.message.chat.id; // معرف العميل
            const userMessage = update.message.text; // نص رسالة العميل

            // تحديث الرسائل على الصفحة
            const messagesDiv = document.getElementById('messages');
            const message = document.createElement('p');
            message.innerText = `رسالة من ${chatId}: ${userMessage}`;
            messagesDiv.appendChild(message);

            // الرد على العميل
            await sendMessage(chatId, `تم استلام رسالتك: "${userMessage}"`);

            // تحديث الـ offset
            offset = update.update_id + 1;
          }
        }

        // متابعة الرسائل
        setTimeout(() => getUpdates(offset), 1000);
      } catch (error) {
        console.error('Error fetching updates:', error);
      }
    }

    // دالة إرسال الرسائل
    async function sendMessage(chatId, text) {
      try {
        await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            chat_id: chatId,
            text: text,
          }),
        });
      } catch (error) {
        console.error('Error sending message:', error);
      }
    }

    // بدء الحصول على الرسائل
    getUpdates(0);
  </script>
</body>
